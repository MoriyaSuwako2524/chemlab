[export_numpy]

# Path settings
data = "./raw_data/"
out = "./"
prefix = "full_"

# Alignment options
align_ref = "transition_density"

# State selection
state_idx = 1

# Units
energy_unit = "kcal/mol"
ex_energy_unit = "ev" #Excitation energy, instead of the energy of a specific excited state
distance_unit = "ang"
grad_unit = ["kcal/mol", "ang"]
force_unit = ["kcal/mol", "ang"]

# Dataset splitting
train_splits = [1000, 500, 2000]
val_splits = 400
test_splits = 400



# QCHEM MODULE
[multi_states]
use_defaults = "qchem"
spins = [1,3,5,7]

[convert_out_to_inp]
use_defaults = "qchem"


[defaults.qchem]
ref = "ref.in"
charge = 0
spin = 1
file = ""

[traj_split]
use_defaults = "qchem"

input_dir = ""
outdir = ""
split_file = "split.npz"

train = 0
val = 0
test = 0


# SCAN MODULE
[scan1d]
use_defaults = "scan"
inp_path = "./"
out_path = ""
prefix = ""
ref = "ref.in"
row_max = 40
row_start = 2.0
row_distance = -0.02
ncore = 16
njob = 4
scan_limit_init = 5
scan_limit_progress = 4
poll_interval = 60
launcher = "srun"

[defaults.scan]
path = ""
prefix = "scan"
ref = "ref.in"
result_saver_enable = true
result_saver_save_npz = true
result_saver_save_plot = true
result_saver_output_path = "./results"
result_saver_prefix = "result"
result_saver_plot_format = "png"
result_saver_dpi = 300
result_saver_auto_close = true

[qchem_env]
use_defaults = "pete"
project = "soc"


[defaults.osc]
env_script = """
module load intel/2021a # sets icc, ifort, etc.
module load intel/2021.3 # toolchain for MKL
export QC=/home/moriya2524/Software/soc
export QCAUX=/home/zhengpei/q-chem/qcaux
source $QC/bin/qchem.setup.sh
export QCSCRATCH=/scratch/$USER/cache

"""

[defaults.pete]
env_script = """
module purge
export QC=/scratch/moriya/software/soc
export QCAUX=/scratch/zhengpei/q-chem/qcaux
source $QC/bin/qchem.setup.sh
export QCSCRATCH=/scratch/$USER/cache
module load impi/2021.2.0
module load intel/2021.2.0
"""


[run_mecp]
path = "/scratch/moriya/molecule/ref_dir"
file = "ref.in"
out = "./mecp_out"
jobtype = "mecp"
gradient = "analytical"
spin1 = 1
spin2 = 3
nthreads = 16
max_stepsize = 0.1
step_size = 0.01
max_steps = 80
conv = 1e-5

[FD]
path = "./"
outpath = "./out/"
ref = "ref.in"
distance = 0.001
ncore = 32
njob = 8
launcher = "srun"
project = "soc"

[defaults.result_saver]
result_saver_enable = true              # 是否启用ResultSaver (默认开启)
result_saver_save_npz = true            # 是否保存npz文件
result_saver_save_plot = true           # 是否保存图片

result_saver_output_path = "./results"  # 输出目录
result_saver_prefix = "result"          # 文件前缀

result_saver_plot_format = "png"        # 图片格式: png, pdf, svg, jpg
result_saver_dpi = 300                  # 图片分辨率
result_saver_auto_close = true          # 自动关闭图片（节省内存）


[mecp_scan]
use_defaults = "scan"

# 输入/输出路径
ref_file = "ref.in"
out_path = "./mecp_scan/"
prefix = "mecp_scan"

# 自旋态设置
spin1 = 1          # 第一个态的自旋多重度
spin2 = 3          # 第二个态的自旋多重度

# 距离约束设置（关键参数）
restrain_atom_i = 0      # 约束的第一个原子索引（从0开始）
restrain_atom_j = 1      # 约束的第二个原子索引
distance_start = 2.0     # 起始距离 (Å)
distance_end = 3.0       # 结束距离 (Å)
distance_step = 0.1      # 距离步长 (Å)
restrain_k = 100.0      # 约束力常数 (默认 100.0)

# MECP 优化参数
jobtype = "mecp"              # "mecp" 或 "mecp_soc"
gradient_type = "analytical"  # "analytical" 或 "numerical"
mecp_max_steps = 80          # 每个点的最大 MECP 优化步数
mecp_conv = 1e-5             # MECP 收敛标准
step_size = 0.01             # MECP 步长
max_stepsize = 0.1           # 最大步长

# 并行设置
nthreads = 16        # 每个 Q-Chem 任务的线程数
njob = 2             # 同时运行的 scan 点数量
poll_interval = 60   # 轮询间隔（秒）
result_saver_enable = true
result_saver_save_npz = true
result_saver_save_plot = true
result_saver_output_path = "./results"
result_saver_prefix = "result"
result_saver_plot_format = "png"
result_saver_dpi = 300
result_saver_auto_close = true




[prepare_tddft]


mode = "auto"

file = ""           # AIMD模式下的输出文件（逗号分隔多个）
out = "./raw_data/" # 输出目录

# Molecule
charge = 0          # 分子电荷
spin = 1            # 自旋多重度

# Reference file
ref = "ref.in"      # Q-Chem 参考输入文件

dataset_size = 2000

# Units (仅AIMD模式使用)
energy_unit = "kcal/mol"
ex_energy_unit = "ev"
distance_unit = "ang"
grad_unit = ["kcal/mol", "ang"]
force_unit = ["kcal/mol", "ang"]

[phase_lock_dipole]
path = "./"
input = "full_tddft.npz"          #
out = "./"          # 输出目录
prefix = "default"         # 输出文件前缀

[merge_test_data]
dataset_dirs = [
    "/path/to/dataset1/",
    "/path/to/dataset2/",
    "/path/to/dataset3/"
]
prefix = "full_"  # 或者你的数据集前缀
out_dir = "./test_npy/"
out_prefix = "full_"
merge_tddft = "True"

[gpr_kernel]
coord = "./coord.npy"

[align_data]
coord = "coord.npy"
gradient = "gradient.npy"
dipole = "dipole.npy"

[example_config]
config1 = "config1"

[qmmm_training_set_dft]
qmmmpath = "./"
outpath = "./raw_data/"
ref = "ref.in"
prefix = "full_"
qm_coords = "qm_coord.npy"
mm_coords = "mm_coord.npy"
mm_charge = "mm_charge.npy"
qm_type = "qm_type.npy"
windows = 42
qm_spin = 1
qm_charge = 0